<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>refl1d.fasta module &#8212; Refl1D 0.7.7.post1533+gc6a0ac1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/haiku-site.css?v=ccbba224" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script src="_static/documentation_options.js?v=132fb2fb"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>Refl1D 0.7.7.post1533+gc6a0ac1 documentation</span></a></h1>
        <h2 class="heading"><span>refl1d.fasta module</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="Top">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="module-refl1d.fasta">
<span id="refl1d-fasta-module"></span><h1>refl1d.fasta module<a class="headerlink" href="#module-refl1d.fasta" title="Link to this heading">¶</a></h1>
<p>Biomolecule support.</p>
<p><a class="reference internal" href="#refl1d.fasta.Molecule" title="refl1d.fasta.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> lets you define biomolecules with labile hydrogen atoms
specified using tritium (T) in the chemical formula.  The biomolecule object
creates forms with natural isotope ratio, all hydrogen and all deuterium.
Density can be provided as natural density or cell volume.  A %D2O contrast
match value is computed for matching the molecule SLD in the presence of
labile hydrogens.  <a href="#id1"><span class="problematic" id="id2">:method:`Molecule.D2Osld`</span></a> computes the neutron SLD for
the solvated molecule in a %D2O solvent.</p>
<p><a href="#id3"><span class="problematic" id="id4">:fun:`D2Omatch`</span></a> computes the %D2O constrast match value given the fully
hydrogenated and fully deuterated forms.</p>
<p><a class="reference internal" href="#refl1d.fasta.Sequence" title="refl1d.fasta.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> lets you read amino acid and DNA/RNA sequences from FASTA
files.</p>
<p>Tables for common molecules are provided[1]:</p>
<blockquote>
<div><p><em>AMINO_ACID_CODES</em> : amino acids indexed by FASTA code</p>
<p><em>RNA_CODES</em>, DNA_CODES* : nucleic bases indexed by FASTA code</p>
<p><em>RNA_BASES</em>, DNA_BASES* : individual nucleic acid bases</p>
<p><em>NUCLEIC_ACID_COMPONENTS</em>, <em>LIPIDS</em>, <em>CARBOHYDRATE_RESIDUES</em></p>
</div></blockquote>
<p>Neutron SLD for water at 20C is also provided as <em>H2O_SLD</em> and <em>D2O_SLD</em>.</p>
<p>For unmodified protein need to add 2*T and O for terminations.</p>
<p>Assumes that proteins were created in an environment with the usual H/D isotope
ratio on the non-swappable hydrogens.</p>
<p>[1] Perkins, Modern Physical Methods in Biochemistry Part B, 143-265 (1988)</p>
<dl class="py function">
<dt class="sig sig-object py" id="refl1d.fasta.D2Omatch">
<span class="sig-prename descclassname"><span class="pre">refl1d.fasta.</span></span><span class="sig-name descname"><span class="pre">D2Omatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H_sld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_sld</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#D2Omatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.D2Omatch" title="Link to this definition">¶</a></dt>
<dd><p>Find the D2O% concentration of solvent such that neutron SLD of the
material matches the neutron SLD of the solvent.</p>
<p><em>H_sld</em>, <em>D_sld</em> are the SLDs for the hydrogenated and deuterated forms
of the material respectively, where <em>D</em> includes all the labile protons
swapped for deuterons.  Water SLD is calculated at 20 C.</p>
<p>Note that the resulting percentage is only meaningful between
0% to 100%.  Beyond 100% you will need an additional constrast agent
in the 100% D2O solvent to increase the SLD enough to match.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="refl1d.fasta.Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">refl1d.fasta.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natural_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.Molecule" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Specify a biomolecule by name, chemical formula, cell volume and charge.</p>
<p>Labile hydrogen positions should be coded using tritium (T) rather than H.  That
way the tritium can be changed to H[1] for solutions with pure water, H for solutions
with a natural abundance of water or D for solutions with pure deuterium.</p>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h2>
<p><em>formula</em> is the original tritiated formula.  You can create the hydrogenated or
deuterated forms using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">periodictable</span> <span class="kn">import</span> <span class="n">H</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">fast</span>
<span class="n">hydrogenated</span> <span class="o">=</span> <span class="n">isotope_substitution</span>
</pre></div>
</div>
<p>:fun:<a href="#id5"><span class="problematic" id="id6">`</span></a>isotope_substitution(M.formula, ` with <em>formula</em>, T
and periodictable.H or periodictable.D.</p>
<p><em>D2Omatch</em> is the % D2O in H2O required to contrast match the molecule, including
the the proton swapping effect.</p>
<p><em>natural</em>/<em>H</em>/<em>D</em> are the formulae with tritium replaced by naturally occurring D/H ratio,
by pure H and by pure D respectively.  <em>sld</em>/<em>H_sld</em>/<em>D_sld</em> are the corresponding slds.
<em>mass</em> and <em>density</em> are available as <em>H.mass</em> and <em>H.density</em>, etc.</p>
<p><em>charge</em> is the charge on the molecule</p>
<p><em>cell_volume</em> is the estimated cell volume for the molecule</p>
<dl class="py method">
<dt class="sig sig-object py" id="refl1d.fasta.Molecule.D2Osld">
<span class="sig-name descname"><span class="pre">D2Osld</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D2O_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#Molecule.D2Osld"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.Molecule.D2Osld" title="Link to this definition">¶</a></dt>
<dd><p>Neutron SLD of the molecule in a %D2O solvent.</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="refl1d.fasta.Sequence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">refl1d.fasta.</span></span><span class="sig-name descname"><span class="pre">Sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aa'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#Sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.Sequence" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#refl1d.fasta.Molecule" title="refl1d.fasta.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
<p>Convert FASTA sequence into chemical formula.</p>
<p><em>name</em> sequence name
<em>sequence</em> code string
<em>type</em> aa|dna|rna</p>
<blockquote>
<div><p>aa: amino acid sequence
dna: dna sequence
rna: rna sequence</p>
</div></blockquote>
<p>Note: rna sequence files treat T as U and dna sequence files treat U as T.</p>
<dl class="py method">
<dt class="sig sig-object py" id="refl1d.fasta.Sequence.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#Sequence.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.Sequence.load" title="Link to this definition">¶</a></dt>
<dd><p>Load the first FASTA sequence from a file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="refl1d.fasta.Sequence.loadall">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loadall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#Sequence.loadall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.Sequence.loadall" title="Link to this definition">¶</a></dt>
<dd><p>Iterate over sequences in FASTA file, loading each in turn.</p>
<p>Yields one FASTA sequence each cycle.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.fasta.fasta_table">
<span class="sig-prename descclassname"><span class="pre">refl1d.fasta.</span></span><span class="sig-name descname"><span class="pre">fasta_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#fasta_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.fasta_table" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.fasta.isotope_substitution">
<span class="sig-prename descclassname"><span class="pre">refl1d.fasta.</span></span><span class="sig-name descname"><span class="pre">isotope_substitution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">portion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#isotope_substitution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.isotope_substitution" title="Link to this definition">¶</a></dt>
<dd><p>Substitute one atom/isotope in a formula with another in some proportion.</p>
<p><em>formula</em> is the formula being updated.</p>
<p><em>source</em> is the isotope/element to be substituted.</p>
<p><em>target</em> is the replacement isotope/element.</p>
<p><em>portion</em> is the proportion of source which is substituted for target.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.fasta.main">
<span class="sig-prename descclassname"><span class="pre">refl1d.fasta.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.fasta.read_fasta">
<span class="sig-prename descclassname"><span class="pre">refl1d.fasta.</span></span><span class="sig-name descname"><span class="pre">read_fasta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#read_fasta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.read_fasta" title="Link to this definition">¶</a></dt>
<dd><p>Iterate over the sequences in a FASTA file.</p>
<p>Each iteration is a pair (sequence name, sequence codes).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.fasta.test">
<span class="sig-prename descclassname"><span class="pre">refl1d.fasta.</span></span><span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/fasta.html#test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.fasta.test" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="Bottom">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>