<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>refl1d.resolution module &#8212; Refl1D 0.7.7.post1533+gc6a0ac1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/haiku-site.css?v=ccbba224" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script src="_static/documentation_options.js?v=132fb2fb"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>Refl1D 0.7.7.post1533+gc6a0ac1 documentation</span></a></h1>
        <h2 class="heading"><span>refl1d.resolution module</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="Top">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="module-refl1d.resolution">
<span id="refl1d-resolution-module"></span><h1>refl1d.resolution module<a class="headerlink" href="#module-refl1d.resolution" title="Link to this heading">¶</a></h1>
<p>Resolution calculations</p>
<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.FWHM2sigma">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">FWHM2sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#FWHM2sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.FWHM2sigma" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.QL2T">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">QL2T</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#QL2T"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.QL2T" title="Link to this definition">¶</a></dt>
<dd><p>Compute angle from <span class="math notranslate nohighlight">\(Q\)</span> and wavelength.</p>
<div class="math notranslate nohighlight">
\[\theta = \sin^{-1}( |Q| \lambda / 4 \pi )\]</div>
<p>Returns <span class="math notranslate nohighlight">\(\theta\)</span>°.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.QT2L">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">QT2L</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#QT2L"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.QT2L" title="Link to this definition">¶</a></dt>
<dd><p>Compute wavelength from <span class="math notranslate nohighlight">\(Q\)</span> and angle.</p>
<div class="math notranslate nohighlight">
\[\lambda = 4 \pi \sin( \theta )/Q\]</div>
<p>Returns <span class="math notranslate nohighlight">\(\lambda\)</span>Å.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.TL2Q">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">TL2Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#TL2Q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.TL2Q" title="Link to this definition">¶</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(Q\)</span> from angle and wavelength.</p>
<div class="math notranslate nohighlight">
\[Q = 4 \pi \sin(\theta) / \lambda\]</div>
<p>Returns <span class="math notranslate nohighlight">\(Q\)</span> Å<sup>-1</sup></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.TOF2L">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">TOF2L</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_moderator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TOF</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#TOF2L"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.TOF2L" title="Link to this definition">¶</a></dt>
<dd><p>Convert neutron time-of-flight to wavelength.</p>
<div class="math notranslate nohighlight">
\[\lambda = (t/d) (h/n_m)\]</div>
<p>where:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(\lambda\)</span> is wavelength in Å</div>
<div class="line"><span class="math notranslate nohighlight">\(t\)</span> is time-of-flight in <span class="math notranslate nohighlight">\(u\)</span>s</div>
<div class="line"><span class="math notranslate nohighlight">\(h\)</span> is Planck’s constant in erg seconds</div>
<div class="line"><span class="math notranslate nohighlight">\(n_m\)</span> is the neutron mass in g</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.binedges">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">binedges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#binedges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.binedges" title="Link to this definition">¶</a></dt>
<dd><p>Construct bin edges <em>E</em> from bin centers <em>L</em>.</p>
<p>Assuming fixed <span class="math notranslate nohighlight">\(\omega = \Delta\lambda/\lambda\)</span> in the bins, the
edges will be spaced logarithmically at:</p>
<div class="math notranslate nohighlight">
\[\begin{split}E_0     &amp;= \min \lambda \\
E_{i+1} &amp;= E_i + \omega E_i = E_i (1+\omega)\end{split}\]</div>
<p>with centers <span class="math notranslate nohighlight">\(L\)</span> half way between the edges:</p>
<div class="math notranslate nohighlight">
\[L_i = (E_i+E_{i+1})/2
    = (E_i + E_i (1+\omega))/2
    = E_i (2 + \omega)/2\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(E_i\)</span>, we can recover the edges from the centers:</p>
<div class="math notranslate nohighlight">
\[E_i = L_i \frac{2}{2+\omega}\]</div>
<p>The final edge, <span class="math notranslate nohighlight">\(E_{n+1}\)</span>, does not have a corresponding center
<span class="math notranslate nohighlight">\(L_{n+1}\)</span> so we must determine it from the previous edge <span class="math notranslate nohighlight">\(E_n\)</span>:</p>
<div class="math notranslate nohighlight">
\[E_{n+1} = L_n \frac{2}{2+\omega}(1+\omega)\]</div>
<p>The fixed <span class="math notranslate nohighlight">\(\omega\)</span> can be retrieved from the ratio of any pair
of bin centers using:</p>
<div class="math notranslate nohighlight">
\[\frac{L_{i+1}}{L_i} = \frac{ (E_{i+2}+E_{i+1})/2 }{ (E_{i+1}+E_i)/2 }
                  = \frac{ (E_{i+1}(1+\omega)+E_{i+1} }
                          { (E_i(1+\omega)+E_i }
                  = \frac{E_{i+1}}{E_i}
                  = \frac{E_i(1+\omega)}{E_i} = 1 + \omega\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.bins">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dLoL</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.bins" title="Link to this definition">¶</a></dt>
<dd><p>Return bin centers from low to high preserving a fixed resolution.</p>
<p><em>low</em>, <em>high</em> are the minimum and maximum wavelength.
<em>dLoL</em> is the desired resolution FWHM <span class="math notranslate nohighlight">\(\Delta\lambda/\lambda\)</span> for the bins.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.binwidths">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">binwidths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#binwidths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.binwidths" title="Link to this definition">¶</a></dt>
<dd><p>Determine the wavelength dispersion from bin centers <em>L</em>.</p>
<p>The wavelength dispersion <span class="math notranslate nohighlight">\(\Delta\lambda\)</span> is just the difference
between consecutive bin edges, so:</p>
<div class="math notranslate nohighlight">
\[\Delta L_i  = E_{i+1}-E_{i}
            = (1+\omega) E_i - E_i
            = \omega E_i
            = \frac{2 \omega}{2+\omega} L_i\]</div>
<p>where <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> are as defined in <a class="reference internal" href="#refl1d.resolution.binedges" title="refl1d.resolution.binedges"><code class="xref py py-func docutils literal notranslate"><span class="pre">binedges()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.dQ_broadening">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">dQ_broadening</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dQ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#dQ_broadening"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.dQ_broadening" title="Link to this definition">¶</a></dt>
<dd><p>Broaden an existing dQ by the given divergence.</p>
<p><em>dQ</em> Å<sup>-1</sup>, with 1-<span class="math notranslate nohighlight">\(\sigma\)</span> <span class="math notranslate nohighlight">\(Q\)</span> resolution
<em>L</em> Å
<em>T</em>, <em>dT</em> °, with FWHM angular divergence
<em>width</em> °, with FWHM increased angular divergence</p>
<p>The calculation is derived by substituting
<span class="math notranslate nohighlight">\(\Delta\theta' = \Delta\theta + \omega\)</span> for sample broadening <span class="math notranslate nohighlight">\(\omega\)</span>
into the resolution estimate
<span class="math notranslate nohighlight">\((\Delta Q/Q)^2 = (\Delta\lambda/\lambda)^2 + (\Delta\theta/\tan\theta)^2\)</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.dQdL2dT">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">dQdL2dT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dQ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#dQdL2dT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.dQdL2dT" title="Link to this definition">¶</a></dt>
<dd><p>Convert a calculated Q resolution and wavelength dispersion to
angular divergence.</p>
<p><em>Q</em>, <em>dQ</em> Å<sup>-1</sup>  <span class="math notranslate nohighlight">\(Q\)</span> and 1-<span class="math notranslate nohighlight">\(\sigma\)</span> <span class="math notranslate nohighlight">\(Q\)</span> resolution
<em>L</em>, <em>dL</em> ° angle and FWHM angular divergence</p>
<p>Returns FWHM Deltatheta$</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.dQdT2dLoL">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">dQdT2dLoL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dQ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dT</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#dQdT2dLoL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.dQdT2dLoL" title="Link to this definition">¶</a></dt>
<dd><p>Convert a calculated Q resolution and angular divergence to a
wavelength dispersion.</p>
<p><em>Q</em>, <em>dQ</em> Å<sup>-1</sup>  <span class="math notranslate nohighlight">\(Q\)</span> and 1-<span class="math notranslate nohighlight">\(\sigma\)</span> <span class="math notranslate nohighlight">\(Q\)</span> resolution
<em>T</em>, <em>dT</em> ° angle and FWHM angular divergence</p>
<p>Returns FWHM <span class="math notranslate nohighlight">\(\Delta\lambda/\lambda\)</span></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.dTdL2dQ">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">dTdL2dQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dT</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#dTdL2dQ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.dTdL2dQ" title="Link to this definition">¶</a></dt>
<dd><p>Convert wavelength dispersion and angular divergence to <span class="math notranslate nohighlight">\(Q\)</span> resolution.</p>
<p><em>T</em>, <em>dT</em>  (degrees) angle and FWHM angular divergence
<em>L</em>, <em>dL</em>  (Angstroms) wavelength and FWHM wavelength dispersion</p>
<p>Returns 1-<span class="math notranslate nohighlight">\(\sigma\)</span> <span class="math notranslate nohighlight">\(\Delta Q\)</span></p>
<p>Given <span class="math notranslate nohighlight">\(Q = 4 \pi sin(\theta)/\lambda\)</span>, this follows directly from
gaussian error propagation using</p>
<p>..math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">Delta</span> <span class="n">Q</span><span class="o">^</span><span class="mi">2</span>
    <span class="o">&amp;=</span> \<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span>\<span class="n">partial</span> <span class="n">Q</span><span class="p">}{</span>\<span class="n">partial</span> \<span class="k">lambda</span><span class="p">}</span>\<span class="n">right</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>\<span class="n">Delta</span>\<span class="k">lambda</span><span class="o">^</span><span class="mi">2</span>
    <span class="o">+</span> \<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span>\<span class="n">partial</span> <span class="n">Q</span><span class="p">}{</span>\<span class="n">partial</span> \<span class="n">theta</span><span class="p">}</span>\<span class="n">right</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>\<span class="n">Delta</span>\<span class="n">theta</span><span class="o">^</span><span class="mi">2</span>

    <span class="o">&amp;=</span> <span class="n">Q</span><span class="o">^</span><span class="mi">2</span> \<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span>\<span class="n">Delta</span> \<span class="k">lambda</span><span class="p">}{</span>\<span class="k">lambda</span><span class="p">}</span>\<span class="n">right</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
    <span class="o">+</span> <span class="n">Q</span><span class="o">^</span><span class="mi">2</span> \<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span>\<span class="n">Delta</span> \<span class="n">theta</span><span class="p">}{</span>\<span class="n">tan</span> \<span class="n">theta</span><span class="p">}</span>\<span class="n">right</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>

    <span class="o">&amp;=</span> <span class="n">Q</span><span class="o">^</span><span class="mi">2</span> \<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span>\<span class="n">Delta</span> \<span class="k">lambda</span><span class="p">}{</span>\<span class="k">lambda</span><span class="p">}</span>\<span class="n">right</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
    <span class="o">+</span> \<span class="n">left</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span><span class="mi">4</span>\<span class="n">pi</span>\<span class="n">cos</span>\<span class="n">theta</span>\<span class="p">,</span>\<span class="n">Delta</span>\<span class="n">theta</span><span class="p">}{</span>\<span class="k">lambda</span><span class="p">}</span>\<span class="n">right</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<p>with the final form chosen to avoid cancellation at <span class="math notranslate nohighlight">\(Q=0\)</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.divergence">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_broadening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.divergence" title="Link to this definition">¶</a></dt>
<dd><p>Calculate divergence due to slit and sample geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><em>T</em><span class="classifier">float OR [float] | degrees</span></dt><dd><p>incident angles</p>
</dd>
<dt><em>slits</em><span class="classifier">float OR (float, float) | mm</span></dt><dd><p>s1, s2 slit openings for slit 1 and slit 2</p>
</dd>
<dt><em>distance</em><span class="classifier">(float, float) | mm</span></dt><dd><p>d1, d2 distance from sample to slit 1 and slit 2</p>
</dd>
<dt><em>sample_width</em><span class="classifier">float | mm</span></dt><dd><p>w, width of the sample</p>
</dd>
<dt><em>sample_broadening</em><span class="classifier">float | degrees FWHM</span></dt><dd><p>additional divergence caused by sample</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><em>dT</em><span class="classifier">float OR [float] | degrees FWHM</span></dt><dd><p>calculated angular divergence</p>
</dd>
</dl>
</dd>
</dl>
<p><strong>Algorithm:</strong></p>
<p>The divergence is based on the slit openings and the distance between
the slits.  For very small samples, where the slit opening is larger
than the width of the sample across the beam, the sample itself acts
like the second slit.</p>
<p>First find <span class="math notranslate nohighlight">\(p\)</span>, the projection of the beam on the sample:</p>
<div class="math notranslate nohighlight">
\[p &amp;= w \sin\left(\frac{\pi}{180}\theta\right)\]</div>
<p>Depending on whether <span class="math notranslate nohighlight">\(p\)</span> is larger than <span class="math notranslate nohighlight">\(s_2\)</span>, determine the slit
divergence <span class="math notranslate nohighlight">\(\Delta\theta_d\)</span> in radians:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Delta\theta_d &amp;= \left\{
  \begin{array}{ll}
    \frac{1}{2}\frac{s_1+s_2}{d_1-d_2} &amp; \mbox{if } p \geq s_2 \\
    \frac{1}{2}\frac{s_1+p}{d_1}       &amp; \mbox{if } p &lt; s_2
  \end{array}
\right.\end{split}\]</div>
<p>In addition to the slit divergence, we need to add in any sample
broadening <span class="math notranslate nohighlight">\(\Delta\theta_s\)</span> returning the total divergence in degrees:</p>
<div class="math notranslate nohighlight">
\[\Delta\theta &amp;= \frac{180}{\pi} \Delta\theta_d + \Delta\theta_s\]</div>
<p>Reversing this equation, the sample broadening contribution can
be measured from the full width at half maximum of the rocking
curve, <span class="math notranslate nohighlight">\(B\)</span>, measured in degrees at a particular angle and slit
opening:</p>
<div class="math notranslate nohighlight">
\[\Delta\theta_s = B - \frac{180}{\pi}\Delta\theta_d\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.sigma2FWHM">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">sigma2FWHM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#sigma2FWHM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.sigma2FWHM" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="refl1d.resolution.slit_widths">
<span class="sig-prename descclassname"><span class="pre">refl1d.resolution.</span></span><span class="sig-name descname"><span class="pre">slit_widths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slits_at_Tlo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tlo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Thi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slits_below</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slits_above</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/refl1d/resolution.html#slit_widths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#refl1d.resolution.slit_widths" title="Link to this definition">¶</a></dt>
<dd><p>Compute the slit widths for the standard scanning reflectometer
fixed-opening-fixed geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><em>T</em><span class="classifier">[float] | degrees</span></dt><dd><p>Specular measurement angles.</p>
</dd>
<dt><em>Tlo</em>, <em>Thi</em><span class="classifier">float | degrees</span></dt><dd><p>Start and end of the opening region.  The default if <em>Tlo</em> is
not specified is to use fixed slits at <em>slits_below</em> for all
angles.</p>
</dd>
<dt><em>slits_below</em>, <em>slits_above</em><span class="classifier">float OR [float, float] | mm</span></dt><dd><p>Slits outside opening region.  The default is to use the
values of the slits at the ends of the opening region.</p>
</dd>
<dt><em>slits_at_Tlo</em><span class="classifier">float OR [float, float] | mm</span></dt><dd><p>Slits at the start of the opening region.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><em>s1</em>, <em>s2</em><span class="classifier">[float] | mm</span></dt><dd><p>Slit widths for each theta.</p>
</dd>
</dl>
</dd>
</dl>
<p>Slits are assumed to be fixed below angle <em>Tlo</em> and above angle <em>Thi</em>,
and opening at a constant dT/T between them.</p>
<p>Slit openings are defined by a tuple (s1, s2) or constant s=s1=s2.
With no <em>Tlo</em>, the slits are fixed with widths defined by <em>slits_below</em>,
which defaults to <em>slits_at_Tlo</em>.  With no <em>Thi</em>, slits are continuously
opening above <em>Tlo</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function works equally well if angles are measured in
radians and/or slits are measured in inches.</p>
</div>
</dd></dl>

</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="Bottom">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>